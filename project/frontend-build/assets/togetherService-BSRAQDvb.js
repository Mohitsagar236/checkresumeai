import{b as T}from"./api-auth-dsn4brwG.js";import{A as e,S as A}from"./groqService-BCUWlnQf.js";import{E as h}from"./heavy-pages-C8trrwvk.js";import"./vendor-x74MHN4I.js";import"./utilities-CaqBGVfY.js";import"./react-vendor-GyENwBWe.js";import"./pdfjs-Cev1TANf.js";import"./ui-components-C10pzA45.js";const k=async(m,r)=>{var l;try{console.log("Analyzing resume with Together AI for job role:",r),!e.TOGETHER_API_KEY||e.TOGETHER_API_KEY;const p=`
      Job Role: ${r}
      
      Resume Text:
      ${m.text}
      
      Sections:
      ${Object.entries(m.sections).filter(([,o])=>o).map(([o,c])=>`${o.toUpperCase()}: ${c}`).join(`

`)}
    `,s=(await T.post(`${e.TOGETHER_API_BASE_URL}/chat/completions`,{model:e.TOGETHER_RESUME_ANALYSIS_MODEL,messages:[{role:"system",content:A},{role:"user",content:p}],temperature:.1,max_tokens:2048,response_format:{type:"json_object"}},{headers:{Authorization:`Bearer ${e.TOGETHER_API_KEY}`,"Content-Type":"application/json"},timeout:e.API_TIMEOUT})).data.choices[0].message.content;let t;try{t=JSON.parse(s)}catch(o){throw console.error("Failed to parse Together AI response as JSON:",o),new Error("Failed to parse analysis results")}if(!t.atsCompatibilityScore&&t.atsCompatibilityScore!==0)throw new Error("Invalid analysis result format");if(!t.courseSuggestions||t.courseSuggestions.length===0){console.log("Enhancing course suggestions using comprehensive course service");const o=((l=t.skillsAnalysis)==null?void 0:l.missingSkills)||[];t.courseSuggestions=h(o,6)}return console.log("Together AI analysis completed successfully"),t}catch(p){throw console.error("Error analyzing resume with Together AI:",p),new Error("Failed to analyze resume with Together AI. Please try again later.")}},b=async m=>{try{console.log("Getting ATS score with Together AI"),!e.TOGETHER_API_KEY||e.TOGETHER_API_KEY;const r=1e4,p=`Calculate the ATS (Applicant Tracking System) compatibility score for this resume:

${m.length>r?m.substring(0,r)+"...":m}

Analyze the resume for:
- Proper formatting and structure
- Use of standard section headers
- Keyword optimization
- File format compatibility
- Readability by ATS systems

Provide only a numerical score between 0-100 representing ATS compatibility.`;let E=null;for(let a=1;a<=e.MAX_RETRIES;a++){const s=a===1?e.API_TIMEOUT:Math.max(2e4,e.API_TIMEOUT/a);try{console.log(`Together AI ATS scoring attempt ${a}/${e.MAX_RETRIES}`);const c=(await T.post(`${e.TOGETHER_API_BASE_URL}/chat/completions`,{model:e.TOGETHER_RESUME_ANALYSIS_MODEL,messages:[{role:"system",content:'You are an ATS expert. Respond with only a JSON object containing a "score" field with a number between 0-100.'},{role:"user",content:p}],temperature:.1,max_tokens:100,response_format:{type:"json_object"}},{headers:{Authorization:`Bearer ${e.TOGETHER_API_KEY}`,"Content-Type":"application/json"},timeout:s})).data.choices[0].message.content;try{const i=JSON.parse(c),n=typeof i.score=="number"?i.score:75;return console.log("Together AI ATS scoring completed successfully"),{score:Math.min(100,Math.max(0,n))}}catch(i){return console.error("Failed to parse ATS score response:",i),{score:75}}}catch(t){if(E=t,t&&typeof t=="object"&&"code"in t&&t.code==="ECONNABORTED"){if(console.warn(`Together AI ATS timeout on attempt ${a}/${e.MAX_RETRIES} (${s}ms)`),a<e.MAX_RETRIES){const c=e.RETRY_DELAY*Math.pow(2,a-1);console.log(`Retrying after ${c}ms backoff...`),await new Promise(i=>setTimeout(i,c))}continue}if(console.error(`Together AI ATS scoring attempt ${a} failed:`,t),a>=e.MAX_RETRIES)break;const o=e.RETRY_DELAY*a;await new Promise(c=>setTimeout(c,o))}}throw E||new Error("All Together AI ATS retry attempts failed")}catch(r){return console.error("Error getting ATS score with Together AI:",r),r&&typeof r=="object"&&"code"in r&&r.code==="ECONNABORTED"&&console.error("Together AI ATS scoring timed out after multiple attempts"),{score:75}}},O=async(m,r)=>{try{console.log("Analyzing skills with Together AI for job role:",r),!e.TOGETHER_API_KEY||e.TOGETHER_API_KEY;const l=8e3,p=m.length>l?m.substring(0,l)+"...":m,E=`Analyze the skills in this resume for the job role "${r}":

${p}

Identify:
1. Skills that match the job requirements
2. Important skills that are missing
3. Overall skills compatibility score (0-100)
4. Recommendations for improvement

Focus on technical skills, soft skills, and industry-specific competencies relevant to ${r}.`;let a=null;for(let s=1;s<=e.MAX_RETRIES;s++){const t=s===1?e.SKILLS_ANALYSIS_TIMEOUT:Math.max(15e3,e.SKILLS_ANALYSIS_TIMEOUT/s);try{console.log(`Together AI skills analysis attempt ${s}/${e.MAX_RETRIES}`);const i=(await T.post(`${e.TOGETHER_API_BASE_URL}/chat/completions`,{model:e.TOGETHER_RESUME_ANALYSIS_MODEL,messages:[{role:"system",content:"You are a skills analysis expert. Respond with a JSON object containing: score (number 0-100), matchedSkills (array), missingSkills (array), and feedback (string)."},{role:"user",content:E}],temperature:.1,max_tokens:500,response_format:{type:"json_object"}},{headers:{Authorization:`Bearer ${e.TOGETHER_API_KEY}`,"Content-Type":"application/json"},timeout:t})).data.choices[0].message.content;try{const n=JSON.parse(i);return console.log("Together AI skills analysis completed successfully"),{score:typeof n.score=="number"?Math.min(100,Math.max(0,n.score)):75,matchedSkills:Array.isArray(n.matchedSkills)?n.matchedSkills:[],missingSkills:Array.isArray(n.missingSkills)?n.missingSkills:[],feedback:typeof n.feedback=="string"?n.feedback:"Skills analysis completed"}}catch(n){return console.error("Failed to parse skills analysis response:",n),{score:75,matchedSkills:[],missingSkills:[],feedback:"Skills analysis completed with parsing fallback"}}}catch(o){if(a=o,o&&typeof o=="object"&&"code"in o&&o.code==="ECONNABORTED"){if(console.warn(`Together AI timeout on attempt ${s}/${e.MAX_RETRIES} (${t}ms)`),s<e.MAX_RETRIES){const i=e.RETRY_DELAY*Math.pow(2,s-1);console.log(`Retrying after ${i}ms backoff...`),await new Promise(n=>setTimeout(n,i))}continue}if(console.error(`Together AI skills analysis attempt ${s} failed:`,o),s>=e.MAX_RETRIES)break;const c=e.RETRY_DELAY*s;await new Promise(i=>setTimeout(i,c))}}throw a||new Error("All Together AI retry attempts failed")}catch(l){return console.error("Error analyzing skills with Together AI:",l),l&&typeof l=="object"&&"code"in l&&l.code==="ECONNABORTED"&&console.error("Together AI skills analysis timed out after multiple attempts"),{score:75,matchedSkills:[],missingSkills:[],feedback:"Skills analysis completed with error fallback"}}};export{k as analyzeResumeWithTogether,O as analyzeSkillsWithTogether,b as getAtsScoreWithTogether};
