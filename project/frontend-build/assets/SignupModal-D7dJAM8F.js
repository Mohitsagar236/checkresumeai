import{R as g,r as o,j as e}from"./react-vendor-GyENwBWe.js";import{u as O,d as F,B as j}from"./heavy-pages-C8trrwvk.js";import{u as H,D as I,a as B,b as U,c as z,d as q,I as S}from"./useOAuthWithTimeout-CTxafyi4.js";import{X as G,al as W}from"./utilities-CaqBGVfY.js";function _({isOpen:l,onClose:m,onLoginClick:E}){const[h,v]=o.useState("checkresmueai@gmail.com"),[c,k]=o.useState(""),[f,N]=o.useState(""),[P,a]=o.useState(""),[i,x]=o.useState(!1),[J,V]=o.useState(!1),{signUp:R}=O(),{showToast:p}=F(),{handleOAuthSignIn:T,oauthLoading:s,clearOAuthLoading:y}=H(),C=g.useRef(!0),b=g.useRef(l),w=g.useRef(y);g.useEffect(()=>{w.current=y},[y]),o.useEffect(()=>{if(C.current){C.current=!1,b.current=l;return}b.current&&!l&&(v("checkresmueai@gmail.com"),k(""),N(""),a(""),x(!1),w.current()),b.current=l},[l]),o.useEffect(()=>()=>{w.current()},[]);const $=()=>!h||!c||!f?(a("Please fill in all fields"),!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)?c.length<6?(a("Password must be at least 6 characters"),!1):c!==f?(a("Passwords do not match"),!1):!0:(a("Please enter a valid email address"),!1),D=async r=>{if(r.preventDefault(),console.log("ðŸ“ [SignupModal] Form submission started"),a(""),!$()){console.log("[SignupModal] Form validation failed");return}x(!0),console.log("ðŸ“§ [SignupModal] Starting enhanced email signup process");let t=null;const L=new Promise((u,n)=>{t=setTimeout(()=>{console.error("â° [SignupModal] Signup timeout reached (25s)"),n(new Error("Signup is taking longer than expected. Please check your connection and try again."))},25e3)});try{console.log("ðŸ“§ [SignupModal] Attempting email signup...");const u=R(h,c),n=await Promise.race([u,L]);if(t&&(clearTimeout(t),t=null),console.log("âœ… [SignupModal] Signup result received:",{hasUser:!!n.user,hasError:!!n.error}),n.error){console.error("âŒ [SignupModal] Signup error:",n.error.message);const d=M(n.error.message);a(d),p(d,"error");return}if(n.user)console.log("ðŸŽ‰ [SignupModal] Signup successful"),p("Successfully signed up! Please check your email to verify your account.","success"),m();else{console.warn("âš ï¸ [SignupModal] No user or error returned from signup");const d="Signup failed. Please try again.";a(d),p(d,"error")}}catch(u){t&&(clearTimeout(t),t=null),console.error("ðŸ’¥ [SignupModal] Signup exception:",u);const n=u instanceof Error?M(u.message):"An unexpected error occurred during signup. Please try again.";a(n),p(n,"error")}finally{console.log("ðŸ”„ [SignupModal] Clearing loading state"),x(!1),t&&clearTimeout(t)}},M=r=>{const t=r.toLowerCase();return t.includes("user already registered")||t.includes("already exists")?"An account with this email already exists. Please sign in instead.":t.includes("password")&&t.includes("weak")?"Password is too weak. Please use at least 6 characters with a mix of letters and numbers.":t.includes("invalid email")||t.includes("email format")?"Please enter a valid email address.":t.includes("rate limit")||t.includes("too many")?"Too many attempts. Please wait a few minutes before trying again.":t.includes("network")||t.includes("connection")||t.includes("timeout")?"Connection issue. Please check your internet connection and try again.":r.charAt(0).toUpperCase()+r.slice(1)},A=async r=>{if(console.log(`[SignupModal] OAuth signin initiated for ${r}`),s||i){console.log(`[SignupModal] OAuth signin blocked - already loading (oauthLoading: ${s}, isLoading: ${i})`);return}a(""),await T(r,t=>{console.error(`[SignupModal] ${r} sign-in error:`,t),a(t)}),console.log(`[SignupModal] OAuth signin successful for ${r}`),m()};return e.jsx(I,{open:l,onOpenChange:m,children:e.jsxs(B,{className:"stable-modal","data-testid":"signup-modal",style:{width:"448px",maxWidth:"90vw",minHeight:"500px",padding:"24px",transform:"translate(-50%, -50%)",position:"fixed",top:"50%",left:"50%"},children:[e.jsxs(U,{children:[e.jsx(z,{className:"text-2xl font-premium-display font-bold text-center text-gradient-luxury",children:"Join Our Community"}),e.jsx(q,{className:"text-center text-gray-600 dark:text-gray-300 font-luxury",children:"Create your account to unlock premium resume insights"})]}),"        ",e.jsx("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-none rounded-lg p-2",onClick:m,"aria-label":"Close",children:e.jsx(G,{className:"h-5 w-5"})}),e.jsxs("div",{className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:["            ",e.jsxs(j,{type:"button",variant:"outline",className:"w-full h-12 font-luxury border-gradient-premium bg-gradient-to-r from-white to-gray-50 dark:from-slate-800 dark:to-slate-700 group transition-none",onClick:()=>A("google"),disabled:i||!!s,style:{width:"100%",height:"48px"},children:[e.jsxs("svg",{className:`w-5 h-5 mr-2 transition-none ${s==="google"?"animate-spin":""}`,viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"              ",e.jsx("span",{className:"text-gray-700 dark:text-gray-300 transition-none",children:s==="google"?"Processing...":"Google"})]}),"            ",e.jsxs(j,{type:"button",variant:"outline",className:"w-full h-12 font-luxury border-gradient-premium bg-gradient-to-r from-white to-gray-50 dark:from-slate-800 dark:to-slate-700 group transition-none",onClick:()=>A("github"),disabled:i||!!s,style:{width:"100%",height:"48px"},children:["              ",e.jsx(W,{className:`w-5 h-5 mr-2 transition-none ${s==="github"?"animate-spin":""} text-gray-700 dark:text-gray-300`}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 transition-none",children:s==="github"?"Processing...":"GitHub"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gradient-premium opacity-30"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-4 bg-white dark:bg-slate-800 text-gray-500 dark:text-gray-400 font-luxury",children:"Or continue with email"})})]}),e.jsxs("form",{onSubmit:D,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-1",children:["              ",e.jsx(S,{type:"email",placeholder:"Enter your email",value:h,onChange:r=>{v(r.target.value),a("")},disabled:i||!!s,required:!0,"aria-label":"Email",className:"h-12 font-luxury border-gradient-premium bg-gradient-to-r from-white to-gray-50 dark:from-slate-800 dark:to-slate-700 transition-none",style:{height:"48px"}})]}),e.jsxs("div",{className:"space-y-1",children:["              ",e.jsx(S,{type:"password",placeholder:"Create a password (min 6 characters)",value:c,onChange:r=>{k(r.target.value),a("")},disabled:i||!!s,required:!0,"aria-label":"Password",className:"h-12 font-luxury border-gradient-premium bg-gradient-to-r from-white to-gray-50 dark:from-slate-800 dark:to-slate-700 transition-none",style:{height:"48px"}})]}),e.jsxs("div",{className:"space-y-1",children:["              ",e.jsx(S,{type:"password",placeholder:"Confirm your password",value:f,onChange:r=>{N(r.target.value),a("")},disabled:i||!!s,required:!0,"aria-label":"Confirm Password",className:"h-12 font-luxury border-gradient-premium bg-gradient-to-r from-white to-gray-50 dark:from-slate-800 dark:to-slate-700 transition-none",style:{height:"48px"}})]}),P&&e.jsx("div",{className:"text-sm text-red-500 dark:text-red-400 bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border border-red-200 dark:border-red-800 font-luxury",children:P}),"            ",e.jsxs(j,{type:"submit",className:"w-full h-12 btn-premium-luxury font-luxury font-medium text-base relative transition-none",disabled:i||!!s,style:{width:"100%",height:"48px"},children:[e.jsx("span",{className:`${i?"opacity-0":"opacity-100"} transition-none`,children:"Create Account"}),i&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"})})]})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-luxury",children:["Already have an account?"," ",e.jsx("button",{type:"button",onClick:E,className:"text-gradient-luxury font-medium hover:opacity-80 transition-opacity duration-300 underline decoration-2 underline-offset-2",children:"Sign in here"})]})})]})})}const Z=g.memo(_);export{Z as S};
