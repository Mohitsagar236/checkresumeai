<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Started Button Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border-color: #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border-color: #f5c6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border-color: #bee5eb;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .iframe-container {
            width: 100%;
            height: 400px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
    <h1>üîç Get Started Button Debug Test</h1>
    <p>This page helps debug why the Get Started button isn't working.</p>

    <div class="test-section">
        <h2>üåê Application Status Test</h2>
        <button onclick="testAppConnectivity()">Test App Connectivity</button>
        <button onclick="loadAppInFrame()">Load App in Frame</button>
        <div id="connectivity-results"></div>
        <div class="iframe-container" id="app-frame-container" style="display: none;">
            <iframe id="app-frame" src=""></iframe>
        </div>
    </div>

    <div class="test-section">
        <h2>üîó Direct Route Testing</h2>
        <button onclick="testDirectRoute('/upload')">Test /upload Route</button>
        <button onclick="testDirectRoute('/pricing')">Test /pricing Route</button>
        <button onclick="testDirectRoute('/signup')">Test /signup Route</button>
        <div id="route-results"></div>
    </div>

    <div class="test-section">
        <h2>üñ±Ô∏è Button Click Simulation</h2>
        <button onclick="simulateGetStartedClick()">Simulate Get Started Click</button>
        <div id="click-results"></div>
    </div>

    <div class="test-section">
        <h2>üìã Browser Information</h2>
        <div id="browser-info"></div>
    </div>

    <script>
        const APP_URL = 'http://localhost:5178';
        
        function addResult(containerId, className, message) {
            const container = document.getElementById(containerId);
            const result = document.createElement('div');
            result.className = `result ${className}`;
            result.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            container.appendChild(result);
        }

        function testAppConnectivity() {
            addResult('connectivity-results', 'info', 'Testing application connectivity...');
            
            fetch(APP_URL)
                .then(response => {
                    if (response.ok) {
                        addResult('connectivity-results', 'success', `‚úÖ App is running and responding (Status: ${response.status})`);
                        return response.text();
                    } else {
                        throw new Error(`Server responded with status: ${response.status}`);
                    }
                })
                .then(html => {
                    if (html.includes('React') || html.includes('div id="root"')) {
                        addResult('connectivity-results', 'success', '‚úÖ React application detected in response');
                    } else {
                        addResult('connectivity-results', 'error', '‚ö†Ô∏è Response doesn\'t look like a React app');
                    }
                })
                .catch(error => {
                    addResult('connectivity-results', 'error', `‚ùå Connection failed: ${error.message}`);
                });
        }

        function loadAppInFrame() {
            const frameContainer = document.getElementById('app-frame-container');
            const frame = document.getElementById('app-frame');
            
            frame.src = APP_URL;
            frameContainer.style.display = 'block';
            
            addResult('connectivity-results', 'info', 'üìÑ Loading application in iframe...');
            
            frame.onload = () => {
                addResult('connectivity-results', 'success', '‚úÖ Application loaded in iframe successfully');
                
                // Try to access the iframe content after a delay
                setTimeout(() => {
                    try {
                        const iframeDoc = frame.contentDocument || frame.contentWindow.document;
                        const getStartedButton = iframeDoc.querySelector('a[href="/upload"]');
                        
                        if (getStartedButton) {
                            addResult('connectivity-results', 'success', '‚úÖ Get Started button found in iframe!');
                            
                            // Test clicking the button
                            getStartedButton.addEventListener('click', (e) => {
                                addResult('click-results', 'info', 'üñ±Ô∏è Get Started button clicked in iframe');
                            });
                        } else {
                            addResult('connectivity-results', 'error', '‚ùå Get Started button not found in iframe');
                        }
                    } catch (error) {
                        addResult('connectivity-results', 'error', `‚ö†Ô∏è Cannot access iframe content: ${error.message}`);
                    }
                }, 2000);
            };
            
            frame.onerror = () => {
                addResult('connectivity-results', 'error', '‚ùå Failed to load application in iframe');
            };
        }

        function testDirectRoute(route) {
            const fullUrl = `${APP_URL}${route}`;
            addResult('route-results', 'info', `Testing direct navigation to ${route}...`);
            
            // Test if the route is accessible
            fetch(fullUrl)
                .then(response => {
                    if (response.ok) {
                        addResult('route-results', 'success', `‚úÖ Route ${route} is accessible`);
                        
                        // Try to open in new window
                        const testWindow = window.open(fullUrl, '_blank', 'width=800,height=600');
                        if (testWindow) {
                            addResult('route-results', 'success', `‚úÖ Opened ${route} in new window`);
                            setTimeout(() => {
                                if (!testWindow.closed) {
                                    testWindow.close();
                                }
                            }, 3000);
                        } else {
                            addResult('route-results', 'error', `‚ùå Popup blocked or failed to open ${route}`);
                        }
                    } else {
                        addResult('route-results', 'error', `‚ùå Route ${route} returned status: ${response.status}`);
                    }
                })
                .catch(error => {
                    addResult('route-results', 'error', `‚ùå Error accessing ${route}: ${error.message}`);
                });
        }

        function simulateGetStartedClick() {
            addResult('click-results', 'info', 'Simulating Get Started button click...');
            
            // Try to navigate directly
            const uploadUrl = `${APP_URL}/upload`;
            
            try {
                // Method 1: window.open
                const newWindow = window.open(uploadUrl, '_blank');
                if (newWindow) {
                    addResult('click-results', 'success', '‚úÖ Successfully opened upload page with window.open');
                    setTimeout(() => newWindow.close(), 3000);
                } else {
                    addResult('click-results', 'error', '‚ùå window.open was blocked or failed');
                }
                
                // Method 2: location.href (in current window)
                setTimeout(() => {
                    if (confirm('Test navigation in current window? (This will leave this test page)')) {
                        window.location.href = uploadUrl;
                    }
                }, 1000);
                
            } catch (error) {
                addResult('click-results', 'error', `‚ùå Navigation failed: ${error.message}`);
            }
        }

        function displayBrowserInfo() {
            const info = {
                'User Agent': navigator.userAgent,
                'Platform': navigator.platform,
                'Language': navigator.language,
                'Cookies Enabled': navigator.cookieEnabled,
                'Online': navigator.onLine,
                'Popup Blocker': 'Unknown (test with popup to check)',
                'JavaScript Enabled': 'Yes (obviously, since this is running)',
                'Local Storage': localStorage ? 'Available' : 'Not Available',
                'Session Storage': sessionStorage ? 'Available' : 'Not Available'
            };
            
            const container = document.getElementById('browser-info');
            let html = '<div class="result info">';
            for (const [key, value] of Object.entries(info)) {
                html += `<strong>${key}:</strong> ${value}<br>`;
            }
            html += '</div>';
            container.innerHTML = html;
        }

        // Initialize
        window.onload = () => {
            displayBrowserInfo();
            addResult('connectivity-results', 'info', 'üöÄ Debug test initialized. Click buttons above to test.');
        };
    </script>
</body>
</html>
